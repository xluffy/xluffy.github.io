<!DOCTYPE html>
<html lang="en">
  <head>
    
      
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-5JDKMG4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'GTM-5JDKMG4');
</script>

    
    
      <title>
        Build simple backgroud job with RabbitMQ ::
        /home/xluffy
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="·ªû trong m·ªôt b√†i vi·∫øt tr∆∞·ªõc m√¨nh ƒë√£ c√≥ t√¨m hi·ªÉu v·ªÅ Sidekiq - backgroud job, hi·ªÉu c√°ch implement ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh tin c·∫≠y."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://taoquangne.com/post/build-simple-bg-job-with-rabbitmq/" />





<link rel="stylesheet" href="https://taoquangne.com/assets/style.css" />

<link rel="stylesheet" href="https://taoquangne.com/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="https://taoquangne.com/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="https://taoquangne.com/img/favicon.png" />


<link href="https://taoquangne.com/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Build simple backgroud job with RabbitMQ"/>
<meta name="twitter:description" content="·ªû trong m·ªôt b√†i vi·∫øt tr∆∞·ªõc m√¨nh ƒë√£ c√≥ t√¨m hi·ªÉu v·ªÅ Sidekiq - backgroud job, hi·ªÉu c√°ch implement ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh tin c·∫≠y."/>



<meta property="og:title" content="Build simple backgroud job with RabbitMQ" />
<meta property="og:description" content="·ªû trong m·ªôt b√†i vi·∫øt tr∆∞·ªõc m√¨nh ƒë√£ c√≥ t√¨m hi·ªÉu v·ªÅ Sidekiq - backgroud job, hi·ªÉu c√°ch implement ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh tin c·∫≠y." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://taoquangne.com/post/build-simple-bg-job-with-rabbitmq/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2018-08-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-08-27T00:00:00+00:00" />






  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >/home/xluffy ft üçÑ</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">about</a></li>
        
      
        
          <li><a href="/tags">tags</a></li>
        
      
        
          <li><a href="https://github.com/xluffy/til/issues">til</a></li>
        
      
        
          <li><a href="/weekly-summary">weekly-summary</a></li>
        
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">about</a></li>
      
    
      
        <li><a href="/tags">tags</a></li>
      
    
      
        <li><a href="https://github.com/xluffy/til/issues">til</a></li>
      
    
      
        <li><a href="/weekly-summary">weekly-summary</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">Build simple backgroud job with RabbitMQ</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2018-08-27
        </span>

        
          
        
      

      


      
    </div>

    
      <span class="post-tags">
        
          <a href="https://taoquangne.com/tags/rabbitmq/">#rabbitmq</a>&nbsp;
        
          <a href="https://taoquangne.com/tags/bg-job/">#bg-job</a>&nbsp;
        
          <a href="https://taoquangne.com/tags/ruby/">#ruby</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      
      <p>·ªû trong m·ªôt <a href="https://xluffy.github.io/post/sidekiq-how-to-reliability">b√†i vi·∫øt tr∆∞·ªõc</a> m√¨nh ƒë√£ c√≥ t√¨m hi·ªÉu v·ªÅ Sidekiq - backgroud job, hi·ªÉu c√°ch implement ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh tin c·∫≠y. H√¥m nay nh√¢n m·ªôt ng∆∞·ªùi b·∫°n c√≥ h·ªèi v·ªÅ m·ªôt framework kh√°c s·ª≠ d·ª•ng RabbitMQ ƒë·ªÉ l√†m queue, th·∫•y kh√° th√∫ v·ªã n√™n d√†nh ch√∫t th·ªùi gian ƒë·ªçc qu√°.</p>
<p>√ù t∆∞·ªüng l√† s·∫Ω vi·∫øt m·ªôt <code>sender.rb</code> ƒë·ªÉ ƒë√≥ng g√≥i c√°c task th√†nh d·∫°ng message v√† g·ª≠i v√†o queue. M·ªôt <code>worker.rb</code> ch·∫°y ·ªü ch·∫ø ƒë·ªô backgroud s·∫Ω pop task t·ª´ queue ra v√† x·ª≠ l√Ω. Ta c√≥ th·ªÉ ch·∫°y nhi·ªÅu worker ƒë·ªÉ tƒÉng t·ªëc x·ª≠ l√Ω c√°c task n·∫øu c·∫ßn. N√≥i chung √Ω t∆∞·ªüng t∆∞∆°ng t·ª± b√†i tr∆∞·ªõc, kh√¥ng c√≥ g√¨ qu√° ƒë·∫∑c bi·ªát.</p>
<p>·ªû ƒë√¢y m√¨nh s·∫Ω d√πng gem <a href="http://rubybunny.info">bunny</a> ƒë·ªÉ k·∫øt n·ªëi t·ªõi server RabbitMQ, ƒë√¢y l√† m·ªôt gem kh√° ph·ªï bi·∫øn, c√≥ th·ªÉ d√πng cho c·∫£ producer v√† consumer.</p>
<h2 id="1-sender">1. Sender</h2>
<p>ƒê·∫ßu ti√™n ta s·∫Ω c·∫ßn require th∆∞ vi·ªán v√†o ƒë·ªÉ x√†i</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span></code></pre></div><p>Sau ƒë√≥ t·∫°o connect t·ªõi RabbitMQ server, ·ªü ƒë√¢y m√¨nh x√†i m·∫∑c ƒë·ªãnh b·∫±ng vi·ªác k·∫øt n·ªëi v·ªõi <a href="127.0.0.1:5672">127.0.0.1:5672</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e"># create connection</span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span></code></pre></div><p>V√† t·∫°o m·ªôt channel</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e"># create queue</span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span></code></pre></div><p>ƒê·ªÉ c√≥ th·ªÉ g·ª≠i, ta s·∫Ω c·∫ßn khai b√°o m·ªôt queue v√† sau ƒë√≥ publish message v√†o queue</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>empty? ? <span style="color:#e6db74">&#39;Hello World!&#39;</span> : <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">.</span>publish(msg, <span style="color:#e6db74">persistent</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts<span style="color:#e6db74">&#34; [x] Sent </span><span style="color:#e6db74">#{</span>msg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>B√¨nh th∆∞·ªùng ta s·∫Ω c·∫ßn queue c√°c task c·∫ßn x·ª≠ l√Ω t·ªën th·ªùi gian nh∆∞ resize image ho·∫∑c render pdf, nh∆∞ng ·ªü ƒë√¢y ƒë·ªÉ ƒë∆°n gi·∫£n ta s·∫Ω d√πng method <code>Kernel#sleep</code> ƒë·ªÉ fake busy task. Th·ªùi gian sleep s·∫Ω ph·ª• thu·ªôc v√†o s·ªë d·∫•u ch·∫•m <code>.</code> c·ªßa message truy·ªÅn v√†o. V√≠ d·ª• n·∫øu truy·ªÅn v√†o <code>Hello...</code> nghƒ©a l√† s·∫Ω sleep 3 gi√¢y (gi·∫£ s·ª≠ l√† m·∫•t 3 gi√¢y ƒë·ªÉ x·ª≠ l√Ω).</p>
<p>Cu·ªëi c√πng ta c√≥ <code>sender.rb</code> nh∆∞ sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create connection</span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create queue</span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>empty? ? <span style="color:#e6db74">&#39;Hello World!&#39;</span> : <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">.</span>publish(msg, <span style="color:#e6db74">persistent</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts<span style="color:#e6db74">&#34; [x] Sent </span><span style="color:#e6db74">#{</span>msg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><ul>
<li>C√≥ nhi·ªÅu lo·∫°i exchange, nh∆∞ng ·ªü ƒë√¢y ta d√πng default exchange -&gt; ph·∫ßn n√†y s·∫Ω ƒë∆∞·ª£c n√≥i ·ªü kh√∫c sau.</li>
<li>Ngo√†i ra khi <code>publish</code> mesasge, ta g√°n th√™m metadata <code>persistent</code> ƒë·ªÉ n√≥i v·ªõi RabbitMQ l√† s·∫Ω persist message n√†y xu·ªëng ƒëƒ©a. Nh∆∞ng l∆∞u √Ω l√† v·∫´n kh√¥ng ƒë·∫£m b·∫£o 100% kh√¥ng m·∫•t message, l√Ω do l√† RabbitMQ v·∫´n c·∫ßn m·ªôt kho·∫£ng th·ªùi gian nh·ªè ƒë·ªÉ ch·∫•p nh·∫≠n message v√† c√≥ th·ªÉ ch∆∞a l∆∞u k·ªãp xu·ªëng ƒëƒ©a do RabbitMQ kh√¥ng s·ª≠ d·ª•ng <code>fsync(2)</code> v·ªõi m·ªçi message. C∆° ch·∫ø persistent n√†y kh√¥ng ƒë·ªß m·∫°nh nh∆∞ng ƒë·ªß cho c√°c task queue ƒë∆°n gi·∫£n.</li>
</ul>
<h2 id="2-worker">2. Worker</h2>
<p>T∆∞∆°ng t·ª± v·ªõi producer, ta s·∫Ω m·ªü connect v√† channel v√† khai b√°o m·ªôt queue ƒë·ªÉ s·ª≠ d·ª•ng, queue ph·∫£i gi·ªëng v·ªõi producer ·ªü ph√≠a tr√™n. L√≠ do c·∫ßn khai b√°o queue l√† c√≥ th·ªÉ consumer s·∫Ω start tr∆∞·ªõc producer v√† ta c·∫ßn ƒë·∫£m b·∫£o l√† queue ƒë√£ t·ªìn t·∫°i tr∆∞·ªõc khi consumer b·∫Øt ƒë·∫ßu pop message.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">begin</span>
</span></span><span style="display:flex;"><span>  puts <span style="color:#e6db74">&#39; [*] Waiting for messages. To exit press CTRL+C&#39;</span>
</span></span><span style="display:flex;"><span>  q<span style="color:#f92672">.</span>subscribe(<span style="color:#e6db74">block</span>: <span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>_delivery_info, _properties, body<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>    wait <span style="color:#f92672">=</span> body<span style="color:#f92672">.</span>count(<span style="color:#e6db74">&#39;.&#39;</span>)<span style="color:#f92672">.</span>to_i
</span></span><span style="display:flex;"><span>    sleep wait
</span></span><span style="display:flex;"><span>    puts <span style="color:#e6db74">&#34; [x] Receive </span><span style="color:#e6db74">#{</span>body<span style="color:#e6db74">}</span><span style="color:#e6db74"> after </span><span style="color:#e6db74">#{</span>wait<span style="color:#e6db74">}</span><span style="color:#e6db74"> seconds&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">rescue</span> <span style="color:#66d9ef">Interrupt</span> <span style="color:#f92672">=&gt;</span> _
</span></span><span style="display:flex;"><span>  co<span style="color:#f92672">.</span>close
</span></span><span style="display:flex;"><span>  exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>·ªû ƒë√¢y ta s·∫Ω d√πng <code>block:true</code>, n√≥ t∆∞∆°ng t·ª± nh∆∞ ·ªü b√†i tr∆∞·ªõc m√¨nh n√≥i v·ªÅ blocking-queue, ƒë·ªÉ trong tr∆∞·ªùng h·ª£p queue r·ªóng thread s·∫Ω b·ªã block v√† kh√¥ng tr·∫£ v·ªÅ con tr·ªè tr√™n terminal.</p>
<p>M·ªôt l·ª£i ƒëi·ªÉm c·ªßa task-queue ƒë√≥ l√† ta c√≥ th·ªÉ start nhi·ªÅu <code>worker.rb</code> ƒë·ªÉ scale, RabbitMQ s·∫Ω g·ª≠i tu·∫ßn t·ª± round-robin message t·ªõi t·ª´ng worker.</p>
<p>Tuy nhi√™n, m·ªôt task ƒë∆∞·ª£c x·ª≠ l√Ω b·ªüi worker c√≥ th·ªÉ m·∫•t m·ªôt kho·∫£ng th·ªùi gian kh√° d√†i. Chuy·ªán g√¨ x·∫£y ra n·∫øu m·ªôt worker b·ªã crash gi·ªØa ch·ª´ng trong khi x·ª≠ l√Ω message. V·ªõi ƒëo·∫°n code tr√™n, sau khi RabbitMQ g·ª≠i message t·ªõi worker, n√≥ s·∫Ω ngay l·∫≠p t·ª©c g√°n nh√°n cho message ƒë√≥ l√† delete v√† n·∫øu worker crash th√¨ ta m·∫•t h·∫øt s·ªë message ch∆∞a k·ªãp x·ª≠ l√Ω.</p>
<p>RabbitMQ h·ªó tr·ª£ m·ªôt c∆° ch·∫ø g·ªçi l√† <em>message acknowledgment</em>, m·ªôt t√≠n hi·ªáu <code>ack</code> s·∫Ω ƒë∆∞·ª£c g·ª≠i ng∆∞·ª£c l·∫°i RabbitMQ t·ª´ consumer ƒë·ªÉ th√¥ng b√°o l√† message ƒë√£ ƒë∆∞·ª£c nh·∫≠n, ƒë∆∞·ª£c x·ª≠ l√Ω v√† RabbitMQ c√≥ th·ªÉ x√≥a n√≥ ƒëi.</p>
<p>N·∫øu consumer ch·∫øt (channel b·ªã close, connection b·ªã close ho·∫∑c TCP connection r·ªõt k·∫øt n·ªëi), RabbitMQ s·∫Ω hi·ªÉu l√† message ch∆∞a ƒë∆∞·ª£c x·ª≠ l√Ω th√†nh c√¥ng v√† n√≥ s·∫Ω requeue l·∫°i message ƒë√≥, m·ªôt consumer kh√°c c√≥ th·ªÉ pop message ƒë√≥ ra v√† x·ª≠ l√Ω b√¨nh th∆∞·ªùng.</p>
<p>Ta s·∫Ω c·∫ßn s·ª≠a l·∫°i ph·∫ßn subcribe ph√≠a tr√™n v·ªõi <code>manual_ack</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>q<span style="color:#f92672">.</span>subscribe(<span style="color:#e6db74">manunal_ack</span>: <span style="color:#66d9ef">true</span>,  <span style="color:#e6db74">block</span>: <span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>_delivery_info, _properties, body<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>  wait <span style="color:#f92672">=</span> body<span style="color:#f92672">.</span>count(<span style="color:#e6db74">&#39;.&#39;</span>)<span style="color:#f92672">.</span>to_i
</span></span><span style="display:flex;"><span>  sleep wait
</span></span><span style="display:flex;"><span>  puts <span style="color:#e6db74">&#34; [x] Receive </span><span style="color:#e6db74">#{</span>body<span style="color:#e6db74">}</span><span style="color:#e6db74"> after </span><span style="color:#e6db74">#{</span>wait<span style="color:#e6db74">}</span><span style="color:#e6db74"> seconds&#34;</span>
</span></span><span style="display:flex;"><span>  ch<span style="color:#f92672">.</span>ack(delivery_info<span style="color:#f92672">.</span>delivery_tag)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>Ta ƒë√£ gi·∫£i quy·∫øt ƒë∆∞·ª£c v·∫•n ƒë·ªÅ l√† n·∫øu consumer b·ªã crash m√† task c·∫ßn x·ª≠ l√Ω v·∫´n kh√¥ng b·ªã m·∫•t. Nh∆∞ng task v·∫´n s·∫Ω b·ªã m·∫•t n·∫øu RabbitMQ b·ªã crash. Ta c·∫ßn gi·∫£i quy·∫øt ti·∫øp 2 v·∫•n ƒë·ªÅ ƒë√≥ l√†:</p>
<ul>
<li>Queue ph·∫£i durable.</li>
<li>Message c≈©ng ph·∫£i durable.</li>
</ul>
<p>V·ªõi queue, ·ªü m·ªói ƒë·∫ßu producer v√† consumer c·∫ßn khai b√°o <code>channel.queue('hello', durable: true)</code>.</p>
<p>C√≤n v·ªõi message, nh∆∞ ·ªü tr√™n <code>sender.rb</code> ta s·∫Ω d√πng thu·ªôc t√≠nh <code>persistent</code> ƒë·ªÉ ƒë·∫£m b·∫£o m·ªôt ph·∫ßn l√† message s·∫Ω ƒë∆∞·ª£c l∆∞u xu·ªëng ƒëƒ©a.</p>
<p>M·ªôt v·∫•n ƒë·ªÅ ti·∫øp theo ƒë·ªëi v·ªõi vi·ªác x·ª≠ l√Ω round-robin trong worker ƒë√≥ l√† c√°c worker c√≥ th·ªÉ s·∫Ω kh√¥ng ho·∫°t ƒë·ªông ƒë·ªìng ƒë·ªÅu. V√≠ d·ª• ta c√≥ nh·ªØng task v·ªõi s·ªë th·ª© t·ª± l·∫ª l√† c√°c heavy task c·∫ßn nhi·ªÅu th·ªùi gian x·ª≠ l√Ω v√† c√°c task v·ªõi s·ªë th·ª© t·ª± ch·∫µn l√† c√°c task nh·∫π nh√†ng h∆°n. V·∫•n ƒë·ªÅ l√† s·∫Ω c√≥ worker xui x·∫ªo nh·∫≠n to√†n c√°c heavy task v√† l√∫c n√†o c≈©ng busy, nh∆∞ng s·∫Ω c√≥ nh·ªØng worker l·∫°i r·∫•t nh√†n d·ªói. L√≠ do l√† RabbitMQ kh√¥ng bi·∫øt ƒë∆∞·ª£c s·ªë l∆∞·ª£ng <em>unacknowledged messages</em> c·ªßa consumer n√™n n√≥ c·ª© g·ª≠i message tu·∫ßn t·ª± t·ªõi consumer.</p>
<p>ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y, ta s·∫Ω d√πng method <code>prefetch(1)</code> ƒë·ªÉ n√≥i v·ªõi RabbitMQ r·∫±ng kh√¥ng g·ª≠i h∆°n 1 message t·ªõi worker t·∫°i m·ªôt th·ªùi ƒëi·ªÉm, ho·∫∑c kh√¥ng g·ª≠i message cho t·ªõi khi worker g·ª≠i l·∫°i t√≠n hi·ªáu ACK ƒë√£ ho√†n th√†nh message tr∆∞·ªõc ƒë√≥. Thay v√†o ƒë√≥ RabbitMQ s·∫Ω ki·∫øm c√°c worker n√†o ƒëang nh√†n r·ªói v√† g·ª≠i message t·ªõi n√≥.</p>
<p>Cu·ªëi c√πng <code>sender.rb</code> s·∫Ω nh∆∞ sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create connection</span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create queue</span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>, <span style="color:#e6db74">durable</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>empty? ? <span style="color:#e6db74">&#39;Hello World!&#39;</span> : <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">.</span>publish(msg, <span style="color:#e6db74">persistent</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts<span style="color:#e6db74">&#34; [x] Sent </span><span style="color:#e6db74">#{</span>msg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>close
</span></span></code></pre></div><p>V√† <code>worker.rb</code> s·∫Ω nh∆∞ sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>, <span style="color:#e6db74">durable</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ch<span style="color:#f92672">.</span>prefetch(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>puts <span style="color:#e6db74">&#39; [*] Waiting for messages. To exit press CTRL+C&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">begin</span>
</span></span><span style="display:flex;"><span>  q<span style="color:#f92672">.</span>subscribe(<span style="color:#e6db74">manual_ack</span>: <span style="color:#66d9ef">true</span>, <span style="color:#e6db74">block</span>: <span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>_delivery_info, _properties, body<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>    wait <span style="color:#f92672">=</span> body<span style="color:#f92672">.</span>count(<span style="color:#e6db74">&#39;.&#39;</span>)<span style="color:#f92672">.</span>to_i
</span></span><span style="display:flex;"><span>    sleep wait
</span></span><span style="display:flex;"><span>    puts <span style="color:#e6db74">&#34; [x] Receive </span><span style="color:#e6db74">#{</span>body<span style="color:#e6db74">}</span><span style="color:#e6db74"> after </span><span style="color:#e6db74">#{</span>wait<span style="color:#e6db74">}</span><span style="color:#e6db74"> seconds&#34;</span>
</span></span><span style="display:flex;"><span>    ch<span style="color:#f92672">.</span>ack(_delivery_info<span style="color:#f92672">.</span>delivery_tag)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">rescue</span> <span style="color:#66d9ef">Interrupt</span> <span style="color:#f92672">=&gt;</span> _
</span></span><span style="display:flex;"><span>  co<span style="color:#f92672">.</span>close
</span></span><span style="display:flex;"><span>  exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><h2 id="3-sneakers">3. Sneakers</h2>
<p>M·ªôt ng∆∞·ªùi b·∫°n gi·ªõi thi·ªáu cho m√¨nh v·ªÅ <a href="https://github.com/jondot/sneakers">sneakers</a> m√¨nh c√≥ ƒë·ªçc qua m·ªôt x√≠u th√¨ th·∫•y b·∫£n ch·∫•t c≈©ng kh√¥ng kh√°c g√¨ c√°ch sidekiq implement nh∆∞ ·ªü b√†i tr∆∞·ªõc m√¨nh c√≥ n√≥i ngo·∫°i tr·ª´ vi·ªác d√πng RabbitMQ l√†m queue. Th·ª±c ra cu·ªëi c√πng ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh tin c·∫≠y th√¨ v·∫´n ph·∫£i cover ƒë·ªß 3 layer d√π c√≥ d√πng c√°i g√¨ ƒëi chƒÉng n·ªØa:</p>
<ul>
<li>Client ƒë·ªÉ enqueue v√† queue ph·∫£i ƒë·∫£m b·∫£o handle vi·ªác network fail b·∫±ng 1 gi·∫£i ph√°p nh∆∞ local queue nh∆∞ ·ªü b√†i tr∆∞·ªõc m√¨nh trao ƒë·ªïi.</li>
<li>Ph·∫£i ƒë·∫£m b·∫£o queue RabbitMQ ph·∫£i lu√¥n s·ªëng, v·ªõi RabbitMQ th√¨ m√¥ h√¨nh HA c√≥ cluster tuy nhi√™n nh∆∞ ·ªü ph√≠a tr√™n th√¨ vi·ªác <code>persistent</code> c·ªßa rabbitmq v·∫´n kh√¥ng ƒë·∫£m b·∫£o 100% kh√¥ng m·∫•t message =&gt; n√≥i chung m√¨nh th·∫•y redis c≈©ng v·∫≠y nh∆∞ng redis th√¨ ƒë∆°n gi·∫£n, d·ªÖ hi·ªÉu h∆°n.</li>
<li>Worker sneakers ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh tin c·∫≠y c√≥ th·ªÉ d√πng <code>ack</code> nh∆∞ trong v√≠ d·ª• ph√≠a tr√™n, b·∫£n ch·∫•t c≈©ng t∆∞∆°ng t·ª± c√°ch d√πng redis v·ªõi <code>rpoplpush</code> ƒë·ªÉ implement reliable queue =&gt; tuy nhi√™n l√† sidekiq t√≠nh ph√≠ ph·∫ßn n√†y.</li>
</ul>
<p>M·ªôt s·ªë l√Ω do kh√°c khi·∫øn t√°c gi·∫£ vi·∫øt sneakers thay v√¨ d√πng sidekiq nh∆∞ v·∫•n ƒë·ªÅ v·ªÅ performance (x·ª≠ l√Ω ƒëc 1000 req/s v·ªõi ack + persisted so v·ªõi 600 req/s c·ªßa sidekiq), support all core th√¨ t√πy nhi·ªÅu y·∫øu t·ªë ƒë·ªÉ ƒë√°nh ƒë·ªïi.</p>
<h2 id="4-exchange-type">4. Exchange type</h2>
<p>N√≥i th√™m m·ªôt ch√∫t x√≠u l√† message khi ƒë∆∞·ª£c g·ª≠i t·ª´ <code>sender.rb</code> hay producer s·∫Ω kh√¥ng ƒë∆∞·ª£c g·ª≠i tr·ª±c ti·∫øp v√†o queue gi·ªëng c√°c message broker kh√°c, thay v√†o ƒë√≥ n√≥ s·∫Ω ƒë∆∞·ª£c g·ª≠i t·ªõi <strong>exchange</strong> tr∆∞·ªõc, sau ƒë√≥ s·∫Ω ƒë∆∞·ª£c route t·ªõi queue t∆∞∆°ng ·ª©ng =&gt; routing ch√≠nh l√† m·ªôt trong c√°c ∆∞u ƒëi·ªÉm c·ªßa RabbitMQ v·ªõi c√°c mesage broker kh√°c. Ho·∫°t ƒë·ªông nh∆∞ h√¨nh ph√≠a d∆∞·ªõi sau:</p>
<p><img src="https://github.com/ruby-amqp/amqp/raw/master/docs/diagrams/001_hello_world_example_routing.png" alt="routing"></p>
<p>Trong RabbitMQ c≈©ng c√≥ nhi·ªÅu lo·∫°i exchange kh√°c nhau nh∆∞:</p>
<ul>
<li>Direct</li>
<li>Fanout</li>
<li>Topic</li>
<li>Headers</li>
</ul>
<p>·ªû ƒë√¢y m√¨nh s·∫Ω gi·∫£i th√≠ch ng·∫Øn g·ªçn v√† m·ªôt s·ªë use-case c·ªßa t·ª´ng lo·∫°i exchange. Chi ti·∫øt c√≥ th·ªÉ ƒë·ªçc th√™m trong document c·ªßa RabbitMQ.</p>
<h3 id="41-fanout-exchange">4.1 Fanout Exchange</h3>
<p>Fanout exchange s·∫Ω routing message t·ªõi t·∫•t c·∫£ c√°c queue li√™n quan, n·∫øu c√≥ N queue li√™n quan t·ªõi fanout exchange th√¨ khi m·ªôt message ƒë∆∞·ª£c publish v√†o exchange s·∫Ω c√≥ N b·∫£n copy c·ªßa message ƒë∆∞·ª£c g·ª≠i t·ªõi t·∫•t c·∫£ N queue, √Ω t∆∞·ªüng l√† m·ªôt d·∫°ng <strong>broadcast routing</strong>.</p>
<p align="center"><img src="https://github.com/ruby-amqp/amqp/raw/master/docs/diagrams/004_fanout_exchange.png" alt="004_fanout_exchange" width="70%"/></p>
<p>Fanout Exchange s·∫Ω ph√π h·ª£p v·ªõi c√°c b√†i to√°n d·∫°ng broadcast nh∆∞ c√°c trang sport-news mu·ªën distributing score update t·ªõi t·∫•t c·∫£ c√°c client near-realtime (nghe c√≥ v·∫ª gi·ªëng c√°ch m√† ForzaFootball ƒëang l√†m) ho·∫∑c c√°c ·ª©ng d·ª•ng chat nh√≥m c·∫ßn distrubute message t·ªõi nh·ªØng ng∆∞·ªùi trong nh√≥m.</p>
<h3 id="42-direct-exchange">4.2 Direct Exchange</h3>
<p>Direct exchange l√† lo·∫°i exchange s·∫Ω g·ª≠i message t·ªõi c√°c queue d·ª±a tr√™n message routing key, v√≠ d·ª• message d·∫°ng <code>image.resize</code> s·∫Ω ƒë∆∞·ª£c g·ª≠i t·ªõi queue <code>resize</code>, message d·∫°ng <code>pdf.render</code> s·∫Ω ƒë∆∞·ª£c g·ª≠i t·ªõi <code>render</code>.</p>
<p align="center"><img src="https://github.com/ruby-amqp/amqp/raw/master/docs/diagrams/005_direct_exchange.png" alt="005_direct_exchange" width="70%"/></p>
<p>Direct exchange th∆∞·ªùng ƒë∆∞·ª£c d√πng ƒë·ªÉ distribute tasks gi·ªØa nhi·ªÅu worker theo thu·∫≠t to√°n round-robin.</p>
<p><strong>Default exchange</strong> l√† direct exchange m√† kh√¥ng c√≥ t√™n (nameless), ƒë√¢y l√† m·ªôt tr∆∞·ªùng h·ª£p ƒë·∫∑c bi·ªát, message s·∫Ω ƒë∆∞·ª£c g·ª≠i t·ªõi m·ªôt queue c√≥ t√™n b·∫±ng routing-key c·ªßa message. C√≥ bao nhi√™u message th√¨ s·∫Ω c√≥ b·∫•y nhi√™u queue v√† c√°c queue n√†y s·∫Ω t·ª± ƒë·ªông li√™n k·∫øt v·ªõi default-exchange v·ªõi routing key tr√πng v·ªõi queue-name.</p>
<p>·ªû v√≠ d·ª• tr√™n ta s·ª≠ d·ª•ng ch√≠nh l√† <strong>default exchange</strong>.</p>
<p>V√≠ d·ª• v·ªõi <code>sender.rb</code> nh∆∞ sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create connection</span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create queue</span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>empty? ? <span style="color:#e6db74">&#39;Hello World!&#39;</span> : <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>ch<span style="color:#f92672">.</span>default_exchange<span style="color:#f92672">.</span>publish(msg, <span style="color:#e6db74">routing_key</span>: q<span style="color:#f92672">.</span>name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts<span style="color:#e6db74">&#34; [x] Sent </span><span style="color:#e6db74">#{</span>msg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>Ta s·∫Ω g·ª≠i v√†i message kh√°c nhau v√†o RabbitMQ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; ruby sender.rb <span style="color:#e6db74">&#39;vn&#39;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Sent vn
</span></span><span style="display:flex;"><span>&gt; ruby sender.rb <span style="color:#e6db74">&#39;korea&#39;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Sent korea
</span></span><span style="display:flex;"><span>&gt; ruby sender.rb <span style="color:#e6db74">&#39;jp&#39;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Sent jp 
</span></span></code></pre></div><p>Sau ƒë√≥ list queue tr√™n nh∆∞ sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; rabbitmqadmin list queues
</span></span><span style="display:flex;"><span>+--------------------------------+----------+
</span></span><span style="display:flex;"><span>|              name              | messages |
</span></span><span style="display:flex;"><span>+--------------------------------+----------+
</span></span><span style="display:flex;"><span>| amq.gen-0qxI0SWMYMULK1fsxg--vQ | <span style="color:#ae81ff">1</span>        |
</span></span><span style="display:flex;"><span>| amq.gen-7VOVANd-tWcsp9wHuneYOg | <span style="color:#ae81ff">1</span>        |
</span></span><span style="display:flex;"><span>| amq.gen-hkQSAn_21ppeOjHONtTAmA | <span style="color:#ae81ff">1</span>        |
</span></span><span style="display:flex;"><span>+--------------------------------+----------+
</span></span></code></pre></div><h3 id="43-topic-exchange">4.3 Topic Exchange</h3>
<p>Topic exchange s·∫Ω route messate t·ªõi m·ªôt ho·∫∑c nhi·ªÅu queue d·ª±a tr√™n vi·ªác matching gi·ªØa message routing key v√† m·ªôt pattern n√†o ƒë√≥ ƒë∆∞·ª£c li√™n k·∫øt v·ªõi queue.</p>
<p>M·ªôt v√≠ d·ª• ƒë√≥ l√† vi·ªác routing t·ªõi c√°c geographic location c·ª• th·ªÉ n√†o ƒë√≥. V√≠ d·ª• v·ªõi routing key l√† <code>americas.south.#&quot;</code> message s·∫Ω ƒë∆∞·ª£c g·ª≠i t·ªõi c√°c queue nh∆∞:</p>
<ul>
<li>americas.south</li>
<li>americas.south.brazil</li>
<li>americas.south.brazil.saopaolo</li>
<li>americas.south.chile.santiago</li>
</ul>
<p align="center"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/Multicast.svg/500px-Multicast.svg.png" alt="Multicast" width="50%"/></p>
<h2 id="5-ref">5. Ref</h2>
<ul>
<li><a href="https://www.rabbitmq.com/tutorials/tutorial-two-ruby.html">https://www.rabbitmq.com/tutorials/tutorial-two-ruby.html</a></li>
<li><a href="http://rubybunny.info/articles/exchanges.html">http://rubybunny.info/articles/exchanges.html</a></li>
<li><a href="https://www.rabbitmq.com/tutorials/amqp-concepts.html">https://www.rabbitmq.com/tutorials/amqp-concepts.html</a></li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://taoquangne.com/post/alb-vs-nginx/">
                  <span class="button__icon">‚Üê</span>
                  <span class="button__text">ALB vs nginx</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://taoquangne.com/post/sidekiq-how-to-reliability/">
                  <span class="button__text">Sidekiq, how to reliability?</span>
                  <span class="button__icon">‚Üí</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user"><span> h√†ng nh√† tr·ªìng üå¥ theo <a href="https://creativecommons.org/licenses/by-nc/4.0">gi·∫•y ph√©p CC BY-NC 4.0</a></span><span>Themes created by <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span></div>
      
  </div>
</footer>

<script src="https://taoquangne.com/assets/main.js"></script>
<script src="https://taoquangne.com/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
