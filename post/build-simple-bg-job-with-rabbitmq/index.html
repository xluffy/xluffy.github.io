<!DOCTYPE html>
<html lang="en">
  <head>
    
      
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-5JDKMG4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'GTM-5JDKMG4');
</script>

    
    
      <title>
        Build simple backgroud job with RabbitMQ ::
        /home/xluffy
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="á» trong má»™t bÃ i viáº¿t trÆ°á»›c mÃ¬nh Ä‘Ã£ cÃ³ tÃ¬m hiá»ƒu vá» Sidekiq - backgroud job, hiá»ƒu cÃ¡ch implement Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh tin cáº­y."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://taoquangne.com/post/build-simple-bg-job-with-rabbitmq/" />





<link rel="stylesheet" href="https://taoquangne.com/assets/style.css" />

<link rel="stylesheet" href="https://taoquangne.com/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="https://taoquangne.com/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="https://taoquangne.com/img/favicon.png" />


<link href="https://taoquangne.com/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://taoquangne.com/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Build simple backgroud job with RabbitMQ"/>
<meta name="twitter:description" content="á» trong má»™t bÃ i viáº¿t trÆ°á»›c mÃ¬nh Ä‘Ã£ cÃ³ tÃ¬m hiá»ƒu vá» Sidekiq - backgroud job, hiá»ƒu cÃ¡ch implement Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh tin cáº­y."/>



<meta property="og:title" content="Build simple backgroud job with RabbitMQ" />
<meta property="og:description" content="á» trong má»™t bÃ i viáº¿t trÆ°á»›c mÃ¬nh Ä‘Ã£ cÃ³ tÃ¬m hiá»ƒu vá» Sidekiq - backgroud job, hiá»ƒu cÃ¡ch implement Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh tin cáº­y." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://taoquangne.com/post/build-simple-bg-job-with-rabbitmq/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2018-08-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-08-27T00:00:00+00:00" />






  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >/home/xluffy ft ğŸ„</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">about</a></li>
        
      
        
          <li><a href="/tags">tags</a></li>
        
      
        
          <li><a href="https://github.com/xluffy/til/issues">til</a></li>
        
      
        
          <li><a href="/weekly-summary">weekly-summary</a></li>
        
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">about</a></li>
      
    
      
        <li><a href="/tags">tags</a></li>
      
    
      
        <li><a href="https://github.com/xluffy/til/issues">til</a></li>
      
    
      
        <li><a href="/weekly-summary">weekly-summary</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">Build simple backgroud job with RabbitMQ</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2018-08-27
        </span>

        
          
        
      

      


      
    </div>

    
      <span class="post-tags">
        
          <a href="https://taoquangne.com/tags/rabbitmq/">#rabbitmq</a>&nbsp;
        
          <a href="https://taoquangne.com/tags/bg-job/">#bg-job</a>&nbsp;
        
          <a href="https://taoquangne.com/tags/ruby/">#ruby</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      
      <p>á» trong má»™t <a href="https://xluffy.github.io/post/sidekiq-how-to-reliability">bÃ i viáº¿t trÆ°á»›c</a> mÃ¬nh Ä‘Ã£ cÃ³ tÃ¬m hiá»ƒu vá» Sidekiq - backgroud job, hiá»ƒu cÃ¡ch implement Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh tin cáº­y. HÃ´m nay nhÃ¢n má»™t ngÆ°á»i báº¡n cÃ³ há»i vá» má»™t framework khÃ¡c sá»­ dá»¥ng RabbitMQ Ä‘á»ƒ lÃ m queue, tháº¥y khÃ¡ thÃº vá»‹ nÃªn dÃ nh chÃºt thá»i gian Ä‘á»c quÃ¡.</p>
<p>Ã tÆ°á»Ÿng lÃ  sáº½ viáº¿t má»™t <code>sender.rb</code> Ä‘á»ƒ Ä‘Ã³ng gÃ³i cÃ¡c task thÃ nh dáº¡ng message vÃ  gá»­i vÃ o queue. Má»™t <code>worker.rb</code> cháº¡y á»Ÿ cháº¿ Ä‘á»™ backgroud sáº½ pop task tá»« queue ra vÃ  xá»­ lÃ½. Ta cÃ³ thá»ƒ cháº¡y nhiá»u worker Ä‘á»ƒ tÄƒng tá»‘c xá»­ lÃ½ cÃ¡c task náº¿u cáº§n. NÃ³i chung Ã½ tÆ°á»Ÿng tÆ°Æ¡ng tá»± bÃ i trÆ°á»›c, khÃ´ng cÃ³ gÃ¬ quÃ¡ Ä‘áº·c biá»‡t.</p>
<p>á» Ä‘Ã¢y mÃ¬nh sáº½ dÃ¹ng gem <a href="http://rubybunny.info">bunny</a> Ä‘á»ƒ káº¿t ná»‘i tá»›i server RabbitMQ, Ä‘Ã¢y lÃ  má»™t gem khÃ¡ phá»• biáº¿n, cÃ³ thá»ƒ dÃ¹ng cho cáº£ producer vÃ  consumer.</p>
<h2 id="1-sender">1. Sender</h2>
<p>Äáº§u tiÃªn ta sáº½ cáº§n require thÆ° viá»‡n vÃ o Ä‘á»ƒ xÃ i</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span></code></pre></div><p>Sau Ä‘Ã³ táº¡o connect tá»›i RabbitMQ server, á»Ÿ Ä‘Ã¢y mÃ¬nh xÃ i máº·c Ä‘á»‹nh báº±ng viá»‡c káº¿t ná»‘i vá»›i <a href="127.0.0.1:5672">127.0.0.1:5672</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e"># create connection</span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span></code></pre></div><p>VÃ  táº¡o má»™t channel</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e"># create queue</span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span></code></pre></div><p>Äá»ƒ cÃ³ thá»ƒ gá»­i, ta sáº½ cáº§n khai bÃ¡o má»™t queue vÃ  sau Ä‘Ã³ publish message vÃ o queue</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>empty? ? <span style="color:#e6db74">&#39;Hello World!&#39;</span> : <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">.</span>publish(msg, <span style="color:#e6db74">persistent</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts<span style="color:#e6db74">&#34; [x] Sent </span><span style="color:#e6db74">#{</span>msg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>BÃ¬nh thÆ°á»ng ta sáº½ cáº§n queue cÃ¡c task cáº§n xá»­ lÃ½ tá»‘n thá»i gian nhÆ° resize image hoáº·c render pdf, nhÆ°ng á»Ÿ Ä‘Ã¢y Ä‘á»ƒ Ä‘Æ¡n giáº£n ta sáº½ dÃ¹ng method <code>Kernel#sleep</code> Ä‘á»ƒ fake busy task. Thá»i gian sleep sáº½ phá»¥ thuá»™c vÃ o sá»‘ dáº¥u cháº¥m <code>.</code> cá»§a message truyá»n vÃ o. VÃ­ dá»¥ náº¿u truyá»n vÃ o <code>Hello...</code> nghÄ©a lÃ  sáº½ sleep 3 giÃ¢y (giáº£ sá»­ lÃ  máº¥t 3 giÃ¢y Ä‘á»ƒ xá»­ lÃ½).</p>
<p>Cuá»‘i cÃ¹ng ta cÃ³ <code>sender.rb</code> nhÆ° sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create connection</span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create queue</span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>empty? ? <span style="color:#e6db74">&#39;Hello World!&#39;</span> : <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">.</span>publish(msg, <span style="color:#e6db74">persistent</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts<span style="color:#e6db74">&#34; [x] Sent </span><span style="color:#e6db74">#{</span>msg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><ul>
<li>CÃ³ nhiá»u loáº¡i exchange, nhÆ°ng á»Ÿ Ä‘Ã¢y ta dÃ¹ng default exchange -&gt; pháº§n nÃ y sáº½ Ä‘Æ°á»£c nÃ³i á»Ÿ khÃºc sau.</li>
<li>NgoÃ i ra khi <code>publish</code> mesasge, ta gÃ¡n thÃªm metadata <code>persistent</code> Ä‘á»ƒ nÃ³i vá»›i RabbitMQ lÃ  sáº½ persist message nÃ y xuá»‘ng Ä‘Ä©a. NhÆ°ng lÆ°u Ã½ lÃ  váº«n khÃ´ng Ä‘áº£m báº£o 100% khÃ´ng máº¥t message, lÃ½ do lÃ  RabbitMQ váº«n cáº§n má»™t khoáº£ng thá»i gian nhá» Ä‘á»ƒ cháº¥p nháº­n message vÃ  cÃ³ thá»ƒ chÆ°a lÆ°u ká»‹p xuá»‘ng Ä‘Ä©a do RabbitMQ khÃ´ng sá»­ dá»¥ng <code>fsync(2)</code> vá»›i má»i message. CÆ¡ cháº¿ persistent nÃ y khÃ´ng Ä‘á»§ máº¡nh nhÆ°ng Ä‘á»§ cho cÃ¡c task queue Ä‘Æ¡n giáº£n.</li>
</ul>
<h2 id="2-worker">2. Worker</h2>
<p>TÆ°Æ¡ng tá»± vá»›i producer, ta sáº½ má»Ÿ connect vÃ  channel vÃ  khai bÃ¡o má»™t queue Ä‘á»ƒ sá»­ dá»¥ng, queue pháº£i giá»‘ng vá»›i producer á»Ÿ phÃ­a trÃªn. LÃ­ do cáº§n khai bÃ¡o queue lÃ  cÃ³ thá»ƒ consumer sáº½ start trÆ°á»›c producer vÃ  ta cáº§n Ä‘áº£m báº£o lÃ  queue Ä‘Ã£ tá»“n táº¡i trÆ°á»›c khi consumer báº¯t Ä‘áº§u pop message.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">begin</span>
</span></span><span style="display:flex;"><span>  puts <span style="color:#e6db74">&#39; [*] Waiting for messages. To exit press CTRL+C&#39;</span>
</span></span><span style="display:flex;"><span>  q<span style="color:#f92672">.</span>subscribe(<span style="color:#e6db74">block</span>: <span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>_delivery_info, _properties, body<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>    wait <span style="color:#f92672">=</span> body<span style="color:#f92672">.</span>count(<span style="color:#e6db74">&#39;.&#39;</span>)<span style="color:#f92672">.</span>to_i
</span></span><span style="display:flex;"><span>    sleep wait
</span></span><span style="display:flex;"><span>    puts <span style="color:#e6db74">&#34; [x] Receive </span><span style="color:#e6db74">#{</span>body<span style="color:#e6db74">}</span><span style="color:#e6db74"> after </span><span style="color:#e6db74">#{</span>wait<span style="color:#e6db74">}</span><span style="color:#e6db74"> seconds&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">rescue</span> <span style="color:#66d9ef">Interrupt</span> <span style="color:#f92672">=&gt;</span> _
</span></span><span style="display:flex;"><span>  co<span style="color:#f92672">.</span>close
</span></span><span style="display:flex;"><span>  exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>á» Ä‘Ã¢y ta sáº½ dÃ¹ng <code>block:true</code>, nÃ³ tÆ°Æ¡ng tá»± nhÆ° á»Ÿ bÃ i trÆ°á»›c mÃ¬nh nÃ³i vá» blocking-queue, Ä‘á»ƒ trong trÆ°á»ng há»£p queue rá»—ng thread sáº½ bá»‹ block vÃ  khÃ´ng tráº£ vá» con trá» trÃªn terminal.</p>
<p>Má»™t lá»£i Ä‘iá»ƒm cá»§a task-queue Ä‘Ã³ lÃ  ta cÃ³ thá»ƒ start nhiá»u <code>worker.rb</code> Ä‘á»ƒ scale, RabbitMQ sáº½ gá»­i tuáº§n tá»± round-robin message tá»›i tá»«ng worker.</p>
<p>Tuy nhiÃªn, má»™t task Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi worker cÃ³ thá»ƒ máº¥t má»™t khoáº£ng thá»i gian khÃ¡ dÃ i. Chuyá»‡n gÃ¬ xáº£y ra náº¿u má»™t worker bá»‹ crash giá»¯a chá»«ng trong khi xá»­ lÃ½ message. Vá»›i Ä‘oáº¡n code trÃªn, sau khi RabbitMQ gá»­i message tá»›i worker, nÃ³ sáº½ ngay láº­p tá»©c gÃ¡n nhÃ¡n cho message Ä‘Ã³ lÃ  delete vÃ  náº¿u worker crash thÃ¬ ta máº¥t háº¿t sá»‘ message chÆ°a ká»‹p xá»­ lÃ½.</p>
<p>RabbitMQ há»— trá»£ má»™t cÆ¡ cháº¿ gá»i lÃ  <em>message acknowledgment</em>, má»™t tÃ­n hiá»‡u <code>ack</code> sáº½ Ä‘Æ°á»£c gá»­i ngÆ°á»£c láº¡i RabbitMQ tá»« consumer Ä‘á»ƒ thÃ´ng bÃ¡o lÃ  message Ä‘Ã£ Ä‘Æ°á»£c nháº­n, Ä‘Æ°á»£c xá»­ lÃ½ vÃ  RabbitMQ cÃ³ thá»ƒ xÃ³a nÃ³ Ä‘i.</p>
<p>Náº¿u consumer cháº¿t (channel bá»‹ close, connection bá»‹ close hoáº·c TCP connection rá»›t káº¿t ná»‘i), RabbitMQ sáº½ hiá»ƒu lÃ  message chÆ°a Ä‘Æ°á»£c xá»­ lÃ½ thÃ nh cÃ´ng vÃ  nÃ³ sáº½ requeue láº¡i message Ä‘Ã³, má»™t consumer khÃ¡c cÃ³ thá»ƒ pop message Ä‘Ã³ ra vÃ  xá»­ lÃ½ bÃ¬nh thÆ°á»ng.</p>
<p>Ta sáº½ cáº§n sá»­a láº¡i pháº§n subcribe phÃ­a trÃªn vá»›i <code>manual_ack</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>q<span style="color:#f92672">.</span>subscribe(<span style="color:#e6db74">manunal_ack</span>: <span style="color:#66d9ef">true</span>,  <span style="color:#e6db74">block</span>: <span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>_delivery_info, _properties, body<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>  wait <span style="color:#f92672">=</span> body<span style="color:#f92672">.</span>count(<span style="color:#e6db74">&#39;.&#39;</span>)<span style="color:#f92672">.</span>to_i
</span></span><span style="display:flex;"><span>  sleep wait
</span></span><span style="display:flex;"><span>  puts <span style="color:#e6db74">&#34; [x] Receive </span><span style="color:#e6db74">#{</span>body<span style="color:#e6db74">}</span><span style="color:#e6db74"> after </span><span style="color:#e6db74">#{</span>wait<span style="color:#e6db74">}</span><span style="color:#e6db74"> seconds&#34;</span>
</span></span><span style="display:flex;"><span>  ch<span style="color:#f92672">.</span>ack(delivery_info<span style="color:#f92672">.</span>delivery_tag)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>Ta Ä‘Ã£ giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» lÃ  náº¿u consumer bá»‹ crash mÃ  task cáº§n xá»­ lÃ½ váº«n khÃ´ng bá»‹ máº¥t. NhÆ°ng task váº«n sáº½ bá»‹ máº¥t náº¿u RabbitMQ bá»‹ crash. Ta cáº§n giáº£i quyáº¿t tiáº¿p 2 váº¥n Ä‘á» Ä‘Ã³ lÃ :</p>
<ul>
<li>Queue pháº£i durable.</li>
<li>Message cÅ©ng pháº£i durable.</li>
</ul>
<p>Vá»›i queue, á»Ÿ má»—i Ä‘áº§u producer vÃ  consumer cáº§n khai bÃ¡o <code>channel.queue('hello', durable: true)</code>.</p>
<p>CÃ²n vá»›i message, nhÆ° á»Ÿ trÃªn <code>sender.rb</code> ta sáº½ dÃ¹ng thuá»™c tÃ­nh <code>persistent</code> Ä‘á»ƒ Ä‘áº£m báº£o má»™t pháº§n lÃ  message sáº½ Ä‘Æ°á»£c lÆ°u xuá»‘ng Ä‘Ä©a.</p>
<p>Má»™t váº¥n Ä‘á» tiáº¿p theo Ä‘á»‘i vá»›i viá»‡c xá»­ lÃ½ round-robin trong worker Ä‘Ã³ lÃ  cÃ¡c worker cÃ³ thá»ƒ sáº½ khÃ´ng hoáº¡t Ä‘á»™ng Ä‘á»“ng Ä‘á»u. VÃ­ dá»¥ ta cÃ³ nhá»¯ng task vá»›i sá»‘ thá»© tá»± láº» lÃ  cÃ¡c heavy task cáº§n nhiá»u thá»i gian xá»­ lÃ½ vÃ  cÃ¡c task vá»›i sá»‘ thá»© tá»± cháºµn lÃ  cÃ¡c task nháº¹ nhÃ ng hÆ¡n. Váº¥n Ä‘á» lÃ  sáº½ cÃ³ worker xui xáº»o nháº­n toÃ n cÃ¡c heavy task vÃ  lÃºc nÃ o cÅ©ng busy, nhÆ°ng sáº½ cÃ³ nhá»¯ng worker láº¡i ráº¥t nhÃ n dá»—i. LÃ­ do lÃ  RabbitMQ khÃ´ng biáº¿t Ä‘Æ°á»£c sá»‘ lÆ°á»£ng <em>unacknowledged messages</em> cá»§a consumer nÃªn nÃ³ cá»© gá»­i message tuáº§n tá»± tá»›i consumer.</p>
<p>Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, ta sáº½ dÃ¹ng method <code>prefetch(1)</code> Ä‘á»ƒ nÃ³i vá»›i RabbitMQ ráº±ng khÃ´ng gá»­i hÆ¡n 1 message tá»›i worker táº¡i má»™t thá»i Ä‘iá»ƒm, hoáº·c khÃ´ng gá»­i message cho tá»›i khi worker gá»­i láº¡i tÃ­n hiá»‡u ACK Ä‘Ã£ hoÃ n thÃ nh message trÆ°á»›c Ä‘Ã³. Thay vÃ o Ä‘Ã³ RabbitMQ sáº½ kiáº¿m cÃ¡c worker nÃ o Ä‘ang nhÃ n rá»—i vÃ  gá»­i message tá»›i nÃ³.</p>
<p>Cuá»‘i cÃ¹ng <code>sender.rb</code> sáº½ nhÆ° sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create connection</span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create queue</span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>, <span style="color:#e6db74">durable</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>empty? ? <span style="color:#e6db74">&#39;Hello World!&#39;</span> : <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>q<span style="color:#f92672">.</span>publish(msg, <span style="color:#e6db74">persistent</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts<span style="color:#e6db74">&#34; [x] Sent </span><span style="color:#e6db74">#{</span>msg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>close
</span></span></code></pre></div><p>VÃ  <code>worker.rb</code> sáº½ nhÆ° sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue(<span style="color:#e6db74">&#39;hello&#39;</span>, <span style="color:#e6db74">durable</span>: <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ch<span style="color:#f92672">.</span>prefetch(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>puts <span style="color:#e6db74">&#39; [*] Waiting for messages. To exit press CTRL+C&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">begin</span>
</span></span><span style="display:flex;"><span>  q<span style="color:#f92672">.</span>subscribe(<span style="color:#e6db74">manual_ack</span>: <span style="color:#66d9ef">true</span>, <span style="color:#e6db74">block</span>: <span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>_delivery_info, _properties, body<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>    wait <span style="color:#f92672">=</span> body<span style="color:#f92672">.</span>count(<span style="color:#e6db74">&#39;.&#39;</span>)<span style="color:#f92672">.</span>to_i
</span></span><span style="display:flex;"><span>    sleep wait
</span></span><span style="display:flex;"><span>    puts <span style="color:#e6db74">&#34; [x] Receive </span><span style="color:#e6db74">#{</span>body<span style="color:#e6db74">}</span><span style="color:#e6db74"> after </span><span style="color:#e6db74">#{</span>wait<span style="color:#e6db74">}</span><span style="color:#e6db74"> seconds&#34;</span>
</span></span><span style="display:flex;"><span>    ch<span style="color:#f92672">.</span>ack(_delivery_info<span style="color:#f92672">.</span>delivery_tag)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">rescue</span> <span style="color:#66d9ef">Interrupt</span> <span style="color:#f92672">=&gt;</span> _
</span></span><span style="display:flex;"><span>  co<span style="color:#f92672">.</span>close
</span></span><span style="display:flex;"><span>  exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><h2 id="3-sneakers">3. Sneakers</h2>
<p>Má»™t ngÆ°á»i báº¡n giá»›i thiá»‡u cho mÃ¬nh vá» <a href="https://github.com/jondot/sneakers">sneakers</a> mÃ¬nh cÃ³ Ä‘á»c qua má»™t xÃ­u thÃ¬ tháº¥y báº£n cháº¥t cÅ©ng khÃ´ng khÃ¡c gÃ¬ cÃ¡ch sidekiq implement nhÆ° á»Ÿ bÃ i trÆ°á»›c mÃ¬nh cÃ³ nÃ³i ngoáº¡i trá»« viá»‡c dÃ¹ng RabbitMQ lÃ m queue. Thá»±c ra cuá»‘i cÃ¹ng Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh tin cáº­y thÃ¬ váº«n pháº£i cover Ä‘á»§ 3 layer dÃ¹ cÃ³ dÃ¹ng cÃ¡i gÃ¬ Ä‘i chÄƒng ná»¯a:</p>
<ul>
<li>Client Ä‘á»ƒ enqueue vÃ  queue pháº£i Ä‘áº£m báº£o handle viá»‡c network fail báº±ng 1 giáº£i phÃ¡p nhÆ° local queue nhÆ° á»Ÿ bÃ i trÆ°á»›c mÃ¬nh trao Ä‘á»•i.</li>
<li>Pháº£i Ä‘áº£m báº£o queue RabbitMQ pháº£i luÃ´n sá»‘ng, vá»›i RabbitMQ thÃ¬ mÃ´ hÃ¬nh HA cÃ³ cluster tuy nhiÃªn nhÆ° á»Ÿ phÃ­a trÃªn thÃ¬ viá»‡c <code>persistent</code> cá»§a rabbitmq váº«n khÃ´ng Ä‘áº£m báº£o 100% khÃ´ng máº¥t message =&gt; nÃ³i chung mÃ¬nh tháº¥y redis cÅ©ng váº­y nhÆ°ng redis thÃ¬ Ä‘Æ¡n giáº£n, dá»… hiá»ƒu hÆ¡n.</li>
<li>Worker sneakers Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh tin cáº­y cÃ³ thá»ƒ dÃ¹ng <code>ack</code> nhÆ° trong vÃ­ dá»¥ phÃ­a trÃªn, báº£n cháº¥t cÅ©ng tÆ°Æ¡ng tá»± cÃ¡ch dÃ¹ng redis vá»›i <code>rpoplpush</code> Ä‘á»ƒ implement reliable queue =&gt; tuy nhiÃªn lÃ  sidekiq tÃ­nh phÃ­ pháº§n nÃ y.</li>
</ul>
<p>Má»™t sá»‘ lÃ½ do khÃ¡c khiáº¿n tÃ¡c giáº£ viáº¿t sneakers thay vÃ¬ dÃ¹ng sidekiq nhÆ° váº¥n Ä‘á» vá» performance (xá»­ lÃ½ Ä‘c 1000 req/s vá»›i ack + persisted so vá»›i 600 req/s cá»§a sidekiq), support all core thÃ¬ tÃ¹y nhiá»u yáº¿u tá»‘ Ä‘á»ƒ Ä‘Ã¡nh Ä‘á»•i.</p>
<h2 id="4-exchange-type">4. Exchange type</h2>
<p>NÃ³i thÃªm má»™t chÃºt xÃ­u lÃ  message khi Ä‘Æ°á»£c gá»­i tá»« <code>sender.rb</code> hay producer sáº½ khÃ´ng Ä‘Æ°á»£c gá»­i trá»±c tiáº¿p vÃ o queue giá»‘ng cÃ¡c message broker khÃ¡c, thay vÃ o Ä‘Ã³ nÃ³ sáº½ Ä‘Æ°á»£c gá»­i tá»›i <strong>exchange</strong> trÆ°á»›c, sau Ä‘Ã³ sáº½ Ä‘Æ°á»£c route tá»›i queue tÆ°Æ¡ng á»©ng =&gt; routing chÃ­nh lÃ  má»™t trong cÃ¡c Æ°u Ä‘iá»ƒm cá»§a RabbitMQ vá»›i cÃ¡c mesage broker khÃ¡c. Hoáº¡t Ä‘á»™ng nhÆ° hÃ¬nh phÃ­a dÆ°á»›i sau:</p>
<p><img src="https://github.com/ruby-amqp/amqp/raw/master/docs/diagrams/001_hello_world_example_routing.png" alt="routing"></p>
<p>Trong RabbitMQ cÅ©ng cÃ³ nhiá»u loáº¡i exchange khÃ¡c nhau nhÆ°:</p>
<ul>
<li>Direct</li>
<li>Fanout</li>
<li>Topic</li>
<li>Headers</li>
</ul>
<p>á» Ä‘Ã¢y mÃ¬nh sáº½ giáº£i thÃ­ch ngáº¯n gá»n vÃ  má»™t sá»‘ use-case cá»§a tá»«ng loáº¡i exchange. Chi tiáº¿t cÃ³ thá»ƒ Ä‘á»c thÃªm trong document cá»§a RabbitMQ.</p>
<h3 id="41-fanout-exchange">4.1 Fanout Exchange</h3>
<p>Fanout exchange sáº½ routing message tá»›i táº¥t cáº£ cÃ¡c queue liÃªn quan, náº¿u cÃ³ N queue liÃªn quan tá»›i fanout exchange thÃ¬ khi má»™t message Ä‘Æ°á»£c publish vÃ o exchange sáº½ cÃ³ N báº£n copy cá»§a message Ä‘Æ°á»£c gá»­i tá»›i táº¥t cáº£ N queue, Ã½ tÆ°á»Ÿng lÃ  má»™t dáº¡ng <strong>broadcast routing</strong>.</p>
<p align="center"><img src="https://github.com/ruby-amqp/amqp/raw/master/docs/diagrams/004_fanout_exchange.png" alt="004_fanout_exchange" width="70%"/></p>
<p>Fanout Exchange sáº½ phÃ¹ há»£p vá»›i cÃ¡c bÃ i toÃ¡n dáº¡ng broadcast nhÆ° cÃ¡c trang sport-news muá»‘n distributing score update tá»›i táº¥t cáº£ cÃ¡c client near-realtime (nghe cÃ³ váº» giá»‘ng cÃ¡ch mÃ  ForzaFootball Ä‘ang lÃ m) hoáº·c cÃ¡c á»©ng dá»¥ng chat nhÃ³m cáº§n distrubute message tá»›i nhá»¯ng ngÆ°á»i trong nhÃ³m.</p>
<h3 id="42-direct-exchange">4.2 Direct Exchange</h3>
<p>Direct exchange lÃ  loáº¡i exchange sáº½ gá»­i message tá»›i cÃ¡c queue dá»±a trÃªn message routing key, vÃ­ dá»¥ message dáº¡ng <code>image.resize</code> sáº½ Ä‘Æ°á»£c gá»­i tá»›i queue <code>resize</code>, message dáº¡ng <code>pdf.render</code> sáº½ Ä‘Æ°á»£c gá»­i tá»›i <code>render</code>.</p>
<p align="center"><img src="https://github.com/ruby-amqp/amqp/raw/master/docs/diagrams/005_direct_exchange.png" alt="005_direct_exchange" width="70%"/></p>
<p>Direct exchange thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ distribute tasks giá»¯a nhiá»u worker theo thuáº­t toÃ¡n round-robin.</p>
<p><strong>Default exchange</strong> lÃ  direct exchange mÃ  khÃ´ng cÃ³ tÃªn (nameless), Ä‘Ã¢y lÃ  má»™t trÆ°á»ng há»£p Ä‘áº·c biá»‡t, message sáº½ Ä‘Æ°á»£c gá»­i tá»›i má»™t queue cÃ³ tÃªn báº±ng routing-key cá»§a message. CÃ³ bao nhiÃªu message thÃ¬ sáº½ cÃ³ báº¥y nhiÃªu queue vÃ  cÃ¡c queue nÃ y sáº½ tá»± Ä‘á»™ng liÃªn káº¿t vá»›i default-exchange vá»›i routing key trÃ¹ng vá»›i queue-name.</p>
<p>á» vÃ­ dá»¥ trÃªn ta sá»­ dá»¥ng chÃ­nh lÃ  <strong>default exchange</strong>.</p>
<p>VÃ­ dá»¥ vá»›i <code>sender.rb</code> nhÆ° sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env ruby</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>require <span style="color:#e6db74">&#39;bunny&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create connection</span>
</span></span><span style="display:flex;"><span>co <span style="color:#f92672">=</span> <span style="color:#66d9ef">Bunny</span><span style="color:#f92672">.</span>new
</span></span><span style="display:flex;"><span>co<span style="color:#f92672">.</span>start
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create queue</span>
</span></span><span style="display:flex;"><span>ch <span style="color:#f92672">=</span> co<span style="color:#f92672">.</span>create_channel
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>queue()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>empty? ? <span style="color:#e6db74">&#39;Hello World!&#39;</span> : <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>ch<span style="color:#f92672">.</span>default_exchange<span style="color:#f92672">.</span>publish(msg, <span style="color:#e6db74">routing_key</span>: q<span style="color:#f92672">.</span>name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts<span style="color:#e6db74">&#34; [x] Sent </span><span style="color:#e6db74">#{</span>msg<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>Ta sáº½ gá»­i vÃ i message khÃ¡c nhau vÃ o RabbitMQ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; ruby sender.rb <span style="color:#e6db74">&#39;vn&#39;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Sent vn
</span></span><span style="display:flex;"><span>&gt; ruby sender.rb <span style="color:#e6db74">&#39;korea&#39;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Sent korea
</span></span><span style="display:flex;"><span>&gt; ruby sender.rb <span style="color:#e6db74">&#39;jp&#39;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">[</span>x<span style="color:#f92672">]</span> Sent jp 
</span></span></code></pre></div><p>Sau Ä‘Ã³ list queue trÃªn nhÆ° sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; rabbitmqadmin list queues
</span></span><span style="display:flex;"><span>+--------------------------------+----------+
</span></span><span style="display:flex;"><span>|              name              | messages |
</span></span><span style="display:flex;"><span>+--------------------------------+----------+
</span></span><span style="display:flex;"><span>| amq.gen-0qxI0SWMYMULK1fsxg--vQ | <span style="color:#ae81ff">1</span>        |
</span></span><span style="display:flex;"><span>| amq.gen-7VOVANd-tWcsp9wHuneYOg | <span style="color:#ae81ff">1</span>        |
</span></span><span style="display:flex;"><span>| amq.gen-hkQSAn_21ppeOjHONtTAmA | <span style="color:#ae81ff">1</span>        |
</span></span><span style="display:flex;"><span>+--------------------------------+----------+
</span></span></code></pre></div><h3 id="43-topic-exchange">4.3 Topic Exchange</h3>
<p>Topic exchange sáº½ route messate tá»›i má»™t hoáº·c nhiá»u queue dá»±a trÃªn viá»‡c matching giá»¯a message routing key vÃ  má»™t pattern nÃ o Ä‘Ã³ Ä‘Æ°á»£c liÃªn káº¿t vá»›i queue.</p>
<p>Má»™t vÃ­ dá»¥ Ä‘Ã³ lÃ  viá»‡c routing tá»›i cÃ¡c geographic location cá»¥ thá»ƒ nÃ o Ä‘Ã³. VÃ­ dá»¥ vá»›i routing key lÃ  <code>americas.south.#&quot;</code> message sáº½ Ä‘Æ°á»£c gá»­i tá»›i cÃ¡c queue nhÆ°:</p>
<ul>
<li>americas.south</li>
<li>americas.south.brazil</li>
<li>americas.south.brazil.saopaolo</li>
<li>americas.south.chile.santiago</li>
</ul>
<p align="center"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/Multicast.svg/500px-Multicast.svg.png" alt="Multicast" width="50%"/></p>
<h2 id="5-ref">5. Ref</h2>
<ul>
<li><a href="https://www.rabbitmq.com/tutorials/tutorial-two-ruby.html">https://www.rabbitmq.com/tutorials/tutorial-two-ruby.html</a></li>
<li><a href="http://rubybunny.info/articles/exchanges.html">http://rubybunny.info/articles/exchanges.html</a></li>
<li><a href="https://www.rabbitmq.com/tutorials/amqp-concepts.html">https://www.rabbitmq.com/tutorials/amqp-concepts.html</a></li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://taoquangne.com/post/alb-vs-nginx/">
                  <span class="button__icon">â†</span>
                  <span class="button__text">ALB vs nginx</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://taoquangne.com/post/sidekiq-how-to-reliability/">
                  <span class="button__text">Sidekiq, how to reliability?</span>
                  <span class="button__icon">â†’</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user"><span> hÃ ng nhÃ  trá»“ng ğŸŒ´ theo <a href="https://creativecommons.org/licenses/by-nc/4.0">giáº¥y phÃ©p CC BY-NC 4.0</a></span><span>Themes created by <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span></div>
      
  </div>
</footer>

<script src="https://taoquangne.com/assets/main.js"></script>
<script src="https://taoquangne.com/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
